---
globs: front/**/*.tsx,packages/**/*.tsx
description: –ü—Ä–∞–≤–∏–ª–∞ TypeScript
---

# üìò TypeScript Rules

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã TypeScript

### ‚úÖ –°–¢–†–û–ì–ê–Ø –¢–ò–ü–ò–ó–ê–¶–ò–Ø
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç—Ä–æ–≥–∏–µ —Ç–∏–ø—ã –¥–ª—è –≤—Å–µ—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- –ò–∑–±–µ–≥–∞–π—Ç–µ `any` –∏ `unknown` –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- –ü—Ä–∏–º–µ–Ω—è–π—Ç–µ union types –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ type guards –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–∏–ø–æ–≤

### ‚úÖ –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–ï –¢–ò–ü–û–í –ò–ó @lumon/types
- –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Ç–∏–ø—ã –∏–∑ `@lumon/types`
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–æ—Ç–æ–≤—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –¥–ª—è API
- –ü—Ä–∏–º–µ–Ω—è–π—Ç–µ —Ç–∏–ø—ã –¥–ª—è —Ñ–æ—Ä–º —Å Zod
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–∏–ø—ã –¥–ª—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### ‚úÖ –ö–û–ú–ü–û–ù–ï–ù–¢–ù–ê–Ø –¢–ò–ü–ò–ó–ê–¶–ò–Ø
- –¢–∏–ø–∏–∑–∏—Ä—É–π—Ç–µ –≤—Å–µ props –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ generic —Ç–∏–ø—ã –¥–ª—è –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- –ü—Ä–∏–º–µ–Ω—è–π—Ç–µ discriminated unions –¥–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏–π
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–∏–ø—ã –¥–ª—è —Å–æ–±—ã—Ç–∏–π

## üìù –ü–†–ò–ú–ï–†–´ –ü–†–ê–í–ò–õ–¨–ù–û–ô –¢–ò–ü–ò–ó–ê–¶–ò–ò

### ‚úÖ –ë–∞–∑–æ–≤—ã–µ —Ç–∏–ø—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
```tsx
import React from 'react';
import { User, ApiResponse } from '@lumon/types';

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - –ø—Ä–æ—Å—Ç—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
interface ButtonProps {
  children: React.ReactNode;
  onClick: () => void;
  variant?: 'primary' | 'secondary' | 'destructive';
  disabled?: boolean;
  loading?: boolean;
  className?: string;
}

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
export const Button: React.FC<ButtonProps> = ({
  children,
  onClick,
  variant = 'primary',
  disabled = false,
  loading = false,
  className = ''
}) => {
  return (
    <button
      onClick={onClick}
      disabled={disabled || loading}
      className={`btn btn-${variant} ${className}`}
    >
      {loading ? 'Loading...' : children}
    </button>
  );
};
```

### ‚úÖ –¢–∏–ø–∏–∑–∞—Ü–∏—è —Ñ–æ—Ä–º —Å Zod
```tsx
import { z } from 'zod';
import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - —Å—Ö–µ–º–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
const userSchema = z.object({
  name: z.string().min(2, '–ò–º—è –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 2 —Å–∏–º–≤–æ–ª–∞'),
  email: z.string().email('–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email'),
  age: z.number().min(18, '–í–æ–∑—Ä–∞—Å—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 18 –ª–µ—Ç'),
  role: z.enum(['admin', 'user', 'moderator'])
});

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - —Ç–∏–ø –∏–∑ —Å—Ö–µ–º—ã
type UserFormData = z.infer<typeof userSchema>;

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ñ–æ—Ä–º–∞
export const UserForm: React.FC = () => {
  const {
    register,
    handleSubmit,
    formState: { errors, isSubmitting }
  } = useForm<UserFormData>({
    resolver: zodResolver(userSchema)
  });

  const onSubmit = async (data: UserFormData) => {
    try {
      // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
      console.log('Form data:', data);
    } catch (error) {
      console.error('Submit error:', error);
    }
  };

  return (
    <form onSubmit={handleSubmit(onSubmit)}>
      <div>
        <label htmlFor="name">–ò–º—è</label>
        <input
          id="name"
          {...register('name')}
          className={errors.name ? 'error' : ''}
        />
        {errors.name && (
          <span className="error-message">{errors.name.message}</span>
        )}
      </div>

      <div>
        <label htmlFor="email">Email</label>
        <input
          id="email"
          type="email"
          {...register('email')}
          className={errors.email ? 'error' : ''}
        />
        {errors.email && (
          <span className="error-message">{errors.email.message}</span>
        )}
      </div>

      <div>
        <label htmlFor="age">–í–æ–∑—Ä–∞—Å—Ç</label>
        <input
          id="age"
          type="number"
          {...register('age', { valueAsNumber: true })}
          className={errors.age ? 'error' : ''}
        />
        {errors.age && (
          <span className="error-message">{errors.age.message}</span>
        )}
      </div>

      <div>
        <label htmlFor="role">–†–æ–ª—å</label>
        <select
          id="role"
          {...register('role')}
          className={errors.role ? 'error' : ''}
        >
          <option value="user">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</option>
          <option value="moderator">–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä</option>
          <option value="admin">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
        </select>
        {errors.role && (
          <span className="error-message">{errors.role.message}</span>
        )}
      </div>

      <button type="submit" disabled={isSubmitting}>
        {isSubmitting ? '–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...' : '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å'}
      </button>
    </form>
  );
};
```

### ‚úÖ –¢–∏–ø–∏–∑–∞—Ü–∏—è API –∫–ª–∏–µ–Ω—Ç–∞
```tsx
import { User, ApiResponse, PaginatedResponse } from '@lumon/types';

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π API –∫–ª–∏–µ–Ω—Ç
class ApiClient {
  private baseUrl: string;

  constructor(baseUrl: string) {
    this.baseUrl = baseUrl;
  }

  // ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã
  async getUsers(page: number = 1, limit: number = 10): Promise<PaginatedResponse<User>> {
    const response = await fetch(`${this.baseUrl}/users?page=${page}&limit=${limit}`);
    
    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }
    
    return response.json();
  }

  async getUser(id: string): Promise<ApiResponse<User>> {
    const response = await fetch(`${this.baseUrl}/users/${id}`);
    
    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }
    
    return response.json();
  }

  async createUser(userData: Omit<User, 'id' | 'createdAt' | 'updatedAt'>): Promise<ApiResponse<User>> {
    const response = await fetch(`${this.baseUrl}/users`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(userData),
    });
    
    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }
    
    return response.json();
  }

  async updateUser(id: string, userData: Partial<User>): Promise<ApiResponse<User>> {
    const response = await fetch(`${this.baseUrl}/users/${id}`, {
      method: 'PUT',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(userData),
    });
    
    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }
    
    return response.json();
  }

  async deleteUser(id: string): Promise<ApiResponse<void>> {
    const response = await fetch(`${this.baseUrl}/users/${id}`, {
      method: 'DELETE',
    });
    
    if (!response.ok) {
      throw new Error(`HTTP error! status: ${response.status}`);
    }
    
    return response.json();
  }
}

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ö—É–∫ –¥–ª—è API
export const useUsers = (page: number = 1, limit: number = 10) => {
  const [users, setUsers] = React.useState<User[]>([]);
  const [loading, setLoading] = React.useState(false);
  const [error, setError] = React.useState<Error | null>(null);

  React.useEffect(() => {
    const fetchUsers = async () => {
      setLoading(true);
      setError(null);
      
      try {
        const apiClient = new ApiClient('/api');
        const response = await apiClient.getUsers(page, limit);
        setUsers(response.data);
      } catch (err) {
        setError(err instanceof Error ? err : new Error('Unknown error'));
      } finally {
        setLoading(false);
      }
    };

    fetchUsers();
  }, [page, limit]);

  return { users, loading, error };
};
```

### ‚úÖ –¢–∏–ø–∏–∑–∞—Ü–∏—è —Ö—É–∫–æ–≤ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
```tsx
import React, { createContext, useContext, useState, useCallback } from 'react';
import { User } from '@lumon/types';

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
interface AuthContextType {
  user: User | null;
  isAuthenticated: boolean;
  login: (email: string, password: string) => Promise<void>;
  logout: () => void;
  loading: boolean;
  error: string | null;
}

const AuthContext = createContext<AuthContextType | undefined>(undefined);

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä
export const AuthProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {
  const [user, setUser] = useState<User | null>(null);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const login = useCallback(async (email: string, password: string) => {
    setLoading(true);
    setError(null);
    
    try {
      // –õ–æ–≥–∏–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
      const response = await fetch('/api/auth/login', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ email, password }),
      });
      
      if (!response.ok) {
        throw new Error('–ù–µ–≤–µ—Ä–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ');
      }
      
      const userData = await response.json();
      setUser(userData);
    } catch (err) {
      setError(err instanceof Error ? err.message : '–û—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏');
    } finally {
      setLoading(false);
    }
  }, []);

  const logout = useCallback(() => {
    setUser(null);
    setError(null);
  }, []);

  const value: AuthContextType = {
    user,
    isAuthenticated: !!user,
    login,
    logout,
    loading,
    error,
  };

  return (
    <AuthContext.Provider value={value}>
      {children}
    </AuthContext.Provider>
  );
};

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ö—É–∫
export const useAuth = (): AuthContextType => {
  const context = useContext(AuthContext);
  
  if (context === undefined) {
    throw new Error('useAuth must be used within an AuthProvider');
  }
  
  return context;
};
```

### ‚úÖ –¢–∏–ø–∏–∑–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π
```tsx
import React, { useState, useCallback } from 'react';

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
interface SearchEvent {
  query: string;
  filters: {
    category?: string;
    dateRange?: {
      start: Date;
      end: Date;
    };
  };
}

interface SearchResults {
  items: Array<{
    id: string;
    title: string;
    description: string;
    category: string;
  }>;
  total: number;
  page: number;
}

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø–æ–∏—Å–∫–∞
export const SearchComponent: React.FC = () => {
  const [query, setQuery] = useState<string>('');
  const [results, setResults] = useState<SearchResults | null>(null);
  const [loading, setLoading] = useState<boolean>(false);

  const handleSearch = useCallback(async (searchEvent: SearchEvent) => {
    setLoading(true);
    
    try {
      const response = await fetch('/api/search', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(searchEvent),
      });
      
      if (!response.ok) {
        throw new Error('–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞');
      }
      
      const searchResults: SearchResults = await response.json();
      setResults(searchResults);
    } catch (error) {
      console.error('Search error:', error);
    } finally {
      setLoading(false);
    }
  }, []);

  const handleSubmit = useCallback((e: React.FormEvent<HTMLFormElement>) => {
    e.preventDefault();
    
    if (!query.trim()) return;
    
    handleSearch({
      query: query.trim(),
      filters: {}
    });
  }, [query, handleSearch]);

  return (
    <div>
      <form onSubmit={handleSubmit}>
        <input
          type="text"
          value={query}
          onChange={(e: React.ChangeEvent<HTMLInputElement>) => setQuery(e.target.value)}
          placeholder="–ü–æ–∏—Å–∫..."
          disabled={loading}
        />
        <button type="submit" disabled={loading || !query.trim()}>
          {loading ? '–ü–æ–∏—Å–∫...' : '–ù–∞–π—Ç–∏'}
        </button>
      </form>
      
      {results && (
        <div>
          <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã ({results.total})</h3>
          {results.items.map((item) => (
            <div key={item.id}>
              <h4>{item.title}</h4>
              <p>{item.description}</p>
              <span>{item.category}</span>
            </div>
          ))}
        </div>
      )}
    </div>
  );
};
```

## üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û

### ‚ùå –ù–ï –î–ï–õ–ê–ô–¢–ï
```tsx
// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ any
const BadComponent = (props: any) => {
  return <div>{props.title}</div>;
};

// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–∏–ø–∏–∑–∞—Ü–∏–∏
const UntypedComponent = (props) => {
  return <div>{props.title}</div>;
};

// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - —Å–ª–æ–∂–Ω—ã–µ generic —Ç–∏–ø—ã
type ComplexType<T extends Record<string, any>, K extends keyof T> = {
  [P in K]: T[P] extends Function ? T[P] : never;
};

// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–æ–≤ –∏–∑ @lumon/types
interface User {
  id: string;
  name: string;
  // –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–æ–≤
}
```

### ‚úÖ –î–ï–õ–ê–ô–¢–ï –¢–ê–ö
```tsx
// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - —Å—Ç—Ä–æ–≥–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è
interface ButtonProps {
  children: React.ReactNode;
  onClick: () => void;
  disabled?: boolean;
}

const GoodComponent: React.FC<ButtonProps> = ({ children, onClick, disabled }) => {
  return (
    <button onClick={onClick} disabled={disabled}>
      {children}
    </button>
  );
};

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–æ–≤ –∏–∑ @lumon/types
import { User, ApiResponse } from '@lumon/types';

const UserComponent: React.FC<{ user: User }> = ({ user }) => {
  return <div>{user.name}</div>;
};

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - –ø—Ä–æ—Å—Ç—ã–µ generic —Ç–∏–ø—ã
interface ApiResponse<T> {
  data: T;
  success: boolean;
  message?: string;
}
```

## üéØ –õ–£–ß–®–ò–ï –ü–†–ê–ö–¢–ò–ö–ò

### 1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–∏–ø—ã –∏–∑ @lumon/types**
```tsx
// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
import { User, ApiResponse, PaginatedResponse } from '@lumon/types';
```

### 2. **–¢–∏–ø–∏–∑–∏—Ä—É–π—Ç–µ –≤—Å–µ props**
```tsx
// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
interface ComponentProps {
  title: string;
  onClick: () => void;
  children: React.ReactNode;
}
```

### 3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Zod –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏**
```tsx
// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
const schema = z.object({
  name: z.string().min(1),
  email: z.string().email(),
});
```

### 4. **–ü—Ä–∏–º–µ–Ω—è–π—Ç–µ type guards**
```tsx
// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
const isUser = (obj: any): obj is User => {
  return obj && typeof obj.id === 'string' && typeof obj.name === 'string';
};
```

---

**–ü–æ–º–Ω–∏**: TypeScript - —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Ç–∏–ø–æ–≤. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–≥–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏ –Ω–µ —É—Å–ª–æ–∂–Ω—è–π—Ç–µ.