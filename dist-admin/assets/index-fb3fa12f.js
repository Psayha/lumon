import{j as e,m as w,A as Y}from"./animations-d83e2c3f.js";import{a as oe,r as l,R as xe}from"./react-vendor-b993c031.js";import{S as q,L as K,A as O,X as H,I as me,a as Z,C as ee,R as $,b as V,B,U as R,c as he,d as ge,F,P as te,e as se,f as ue,D as ae,T as Q,g as re,H as G,h as ye,i as pe,j as be,M as fe,k as ie,l as je,m as ke,n as we,o as J,p as ne,q as W,r as Ne,s as le,t as ve,u as Se,v as Le,w as Ce,x as _e}from"./icons-3185a26c.js";(function(){const y=document.createElement("link").relList;if(y&&y.supports&&y.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))p(r);new MutationObserver(r=>{for(const m of r)if(m.type==="childList")for(const x of m.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&p(x)}).observe(document,{childList:!0,subtree:!0});function h(r){const m={};return r.integrity&&(m.integrity=r.integrity),r.referrerPolicy&&(m.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?m.credentials="include":r.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function p(r){if(r.ep)return;r.ep=!0;const m=h(r);fetch(r.href,m)}})();var z={},X=oe;z.createRoot=X.createRoot,z.hydrateRoot=X.hydrateRoot;const v={baseUrl:{}.VITE_API_URL||"https://n8n.psayha.ru",endpoints:{adminLogin:"/webhook/admin/login",adminValidate:"/webhook/admin/validate",adminCompaniesList:"/webhook/admin/companies-list",adminLegalDocsList:"/webhook/admin/legal-docs-list",adminLegalDocsUpdate:"/webhook/admin/legal-docs-update",adminAiDocsList:"/webhook/admin/ai-docs-list",adminAiDocsDelete:"/webhook/admin/ai-docs-delete",backupList:"/webhook/admin/backup-list",backupCreate:"/webhook/admin/backup-create",backupRestore:"/webhook/admin/backup-restore",backupDelete:"/webhook/admin/backup-delete",healthCheckList:"/webhook/admin/health-check-list",healthCheck:"/webhook/admin/health-check",adminLogsList:"/webhook/admin/logs-list",adminUsersList:"/webhook/admin/users-list",adminUserLimitsList:"/webhook/admin/user-limits-list",adminUserLimitsUpdate:"/webhook/admin/user-limits-update",adminUserHistoryClear:"/webhook/admin/user-history-clear",adminUserDelete:"/webhook/admin/user-delete",adminStatsPlatform:"/webhook/admin/stats-platform",adminAbExperimentsList:"/webhook/admin/ab-experiments-list",adminAbExperimentCreate:"/webhook/admin/ab-experiment-create",adminAbExperimentUpdate:"/webhook/admin/ab-experiment-update"},timeout:3e4},de=a=>`${v.baseUrl}${a}`,Te=()=>{const a={"Content-Type":"application/json",Accept:"application/json"},y=localStorage.getItem("admin_token");return y&&(a.Authorization=`Bearer ${y}`),a},C=async(a,y={})=>{const h=a.startsWith("http")?a:de(a),p=Te();try{const r=await fetch(h,{...y,headers:{...p,...y.headers||{}}}),m=await r.text(),x=r.headers.get("content-type");let n;if(!m||m.trim()==="")return r.ok?{success:!0,data:void 0}:{success:!1,message:`Ошибка сервера: ${r.status} ${r.statusText||"Internal Server Error"}`};if(x&&x.includes("application/json"))try{n=JSON.parse(m)}catch{return{success:!1,message:`Ошибка сервера ${r.status}: Неверный формат ответа`}}else return r.ok?{success:!0,data:m}:{success:!1,message:`Ошибка сервера ${r.status}: ${m.substring(0,200)}`};return r.ok?n:{success:!1,message:n?.message||n?.error||`Ошибка сервера: ${r.status} ${r.statusText||"Internal Server Error"}`,data:n?.data}}catch(r){return{success:!1,message:r.message||"Ошибка подключения к серверу"}}},Ue=({onLogin:a})=>{const[y,h]=l.useState(""),[p,r]=l.useState(""),[m,x]=l.useState(""),[n,o]=l.useState(!1),d=async g=>{g.preventDefault(),x(""),o(!0);try{const b=await fetch(de(v.endpoints.adminLogin),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:y,password:p})});if(b.ok){const j=await b.json();j.success&&j.data?.token?a(j.data.token):x("Неверный логин или пароль")}else{const j=await b.json().catch(()=>({}));x(j.message||"Неверный логин или пароль")}}catch{x("Ошибка подключения к серверу")}finally{o(!1)}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 dark:from-slate-900 dark:via-slate-800 dark:to-indigo-900 flex items-center justify-center p-4",children:e.jsxs(w.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl p-8 w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl flex items-center justify-center mx-auto mb-4",children:e.jsx(q,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Админ-панель"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Войдите для доступа к управлению"})]}),e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Логин"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(K,{className:"w-5 h-5 text-gray-400"})}),e.jsx("input",{type:"text",value:y,onChange:g=>h(g.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-slate-700 text-gray-900 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Введите логин",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Пароль"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(K,{className:"w-5 h-5 text-gray-400"})}),e.jsx("input",{type:"password",value:p,onChange:g=>r(g.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-slate-700 text-gray-900 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Введите пароль",required:!0})]})]}),m&&e.jsxs(w.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex items-center space-x-2 text-sm text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900/20 p-3 rounded-lg",children:[e.jsx(O,{className:"w-4 h-4"}),e.jsx("span",{children:m})]}),e.jsx("button",{type:"submit",disabled:n,className:"w-full py-2.5 px-4 bg-gradient-to-r from-blue-500 to-indigo-600 text-white font-medium rounded-lg hover:from-blue-600 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:n?"Вход...":"Войти"})]})]})})},ce=l.createContext(void 0),E=()=>{const a=l.useContext(ce);if(!a)throw new Error("useToast must be used within ToastProvider");return a},De=({children:a})=>{const[y,h]=l.useState([]),p=l.useCallback((n,o,d=3e3)=>{const g=Math.random().toString(36).substr(2,9),b={id:g,type:n,message:o,duration:d};h(j=>[...j,b]),setTimeout(()=>{h(j=>j.filter(t=>t.id!==g))},d)},[]),r=l.useCallback(n=>{h(o=>o.filter(d=>d.id!==n))},[]),m=n=>{switch(n){case"success":return e.jsx(ee,{className:"w-5 h-5"});case"error":return e.jsx(Z,{className:"w-5 h-5"});case"warning":return e.jsx(O,{className:"w-5 h-5"});case"info":return e.jsx(me,{className:"w-5 h-5"})}},x=n=>{switch(n){case"success":return"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800 text-green-800 dark:text-green-200";case"error":return"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800 text-red-800 dark:text-red-200";case"warning":return"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800 text-yellow-800 dark:text-yellow-200";case"info":return"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800 text-blue-800 dark:text-blue-200"}};return e.jsxs(ce.Provider,{value:{showToast:p},children:[a,e.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:e.jsx(Y,{children:y.map(n=>e.jsxs(w.div,{initial:{opacity:0,x:300},animate:{opacity:1,x:0},exit:{opacity:0,x:300},className:`flex items-center space-x-3 px-4 py-3 rounded-lg border shadow-lg ${x(n.type)}`,children:[m(n.type),e.jsx("span",{className:"text-sm font-medium",children:n.message}),e.jsx("button",{onClick:()=>r(n.id),className:"ml-2 hover:opacity-70",children:e.jsx(H,{className:"w-4 h-4"})})]},n.id))})})]})},Ae=()=>{const[a,y]=l.useState([]),[h,p]=l.useState(""),[r,m]=l.useState(null),[x,n]=l.useState(!0),[o,d]=l.useState(null),{showToast:g}=E(),b=async()=>{n(!0),d(null);try{const i=await C(v.endpoints.adminCompaniesList);if(i.success&&i.data)y(i.data);else{const f=i.message||"Ошибка сервера: не удалось загрузить компании";d(f),g("error",f)}}catch(i){const f=i?.message||"Ошибка при загрузке компаний";d(f),g("error",f)}finally{n(!1)}};l.useEffect(()=>{b()},[]);const j=a.filter(i=>i.name.toLowerCase().includes(h.toLowerCase())),t=i=>{const f={owner:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400",manager:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400",viewer:"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300"};return f[i]||f.viewer};return x?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):o?e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-6",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(O,{className:"w-6 h-6 text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-red-900 dark:text-red-200 mb-2",children:"Ошибка загрузки данных"}),e.jsx("p",{className:"text-red-700 dark:text-red-300 mb-4",children:o}),e.jsxs("button",{onClick:b,className:"flex items-center space-x-2 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:[e.jsx($,{className:"w-4 h-4"}),e.jsx("span",{children:"Повторить попытку"})]})]})]})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Компании"}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:["Всего компаний: ",a.length]})]})}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(V,{className:"w-5 h-5 text-gray-400"})}),e.jsx("input",{type:"text",value:h,onChange:i=>p(i.target.value),placeholder:"Поиск по названию компании...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-slate-700 text-gray-900 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsx("div",{className:"space-y-4",children:j.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(B,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:h?"Компании не найдены":"Нет компаний"})]}):j.map(i=>e.jsxs(w.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"p-4 cursor-pointer hover:bg-gray-50 dark:hover:bg-slate-700 transition-colors",onClick:()=>m(r===i.id?null:i.id),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(B,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white truncate",children:i.name}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1",children:[e.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500 dark:text-gray-400",children:[e.jsx(R,{className:"w-4 h-4"}),e.jsxs("span",{children:[i.userCount," пользователей"]})]}),e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Создана: ",new Date(i.createdAt).toLocaleDateString("ru-RU")]})]})]})]}),r===i.id?e.jsx(he,{className:"w-5 h-5 text-gray-400 flex-shrink-0"}):e.jsx(ge,{className:"w-5 h-5 text-gray-400 flex-shrink-0"})]})}),r===i.id&&e.jsx(w.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-slate-900/50",children:e.jsxs("div",{className:"p-4 space-y-2",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3",children:"Пользователи:"}),i.users.map(f=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-white dark:bg-slate-800 rounded-lg",children:[e.jsx("span",{className:"text-sm text-gray-900 dark:text-white",children:f.username}),e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${t(f.role)}`,children:f.role})]},f.id))]})})]},i.id))})]})},Ee=()=>{const[a,y]=l.useState([]),[h,p]=l.useState(null),[r,m]=l.useState(""),[x,n]=l.useState(!0),{showToast:o}=E(),d=async()=>{n(!0);try{const t=await C(v.endpoints.adminLegalDocsList);if(t.success&&t.data)y(t.data);else{const i=t.message||"Ошибка сервера: не удалось загрузить документы";o("error",i)}}catch(t){o("error",t?.message||"Ошибка при загрузке документов")}finally{n(!1)}};l.useEffect(()=>{d()},[]);const g=t=>{p(t.id),m(t.content)},b=async t=>{if(!r.trim()){o("error","Содержимое документа не может быть пустым");return}if(r.length>1e5){o("error","Содержимое документа слишком большое (максимум 100000 символов)");return}try{const i=await C(v.endpoints.adminLegalDocsUpdate,{method:"POST",body:JSON.stringify({id:t,content:r})});i.success?(o("success","Документ обновлен"),await d(),p(null),m("")):o("error",i.message||"Не удалось обновить документ")}catch{o("error","Ошибка при обновлении документа")}},j=()=>{p(null),m("")};return x?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Юридические документы"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Управление документами для модалки AgreementModal"})]})}),e.jsx("div",{className:"space-y-4",children:a.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(F,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Нет документов"})]}):a.map(t=>e.jsx(w.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-600 rounded-lg flex items-center justify-center",children:e.jsx(F,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t.title}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Обновлено: ",new Date(t.updatedAt).toLocaleDateString("ru-RU")]})]})]}),h!==t.id&&e.jsxs("button",{onClick:()=>g(t),className:"flex items-center space-x-2 px-3 py-2 text-sm font-medium text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors",children:[e.jsx(te,{className:"w-4 h-4"}),e.jsx("span",{children:"Редактировать"})]})]}),h===t.id?e.jsxs("div",{className:"space-y-3",children:[e.jsx("textarea",{value:r,onChange:i=>m(i.target.value),rows:10,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-slate-700 text-gray-900 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>b(t.id),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(se,{className:"w-4 h-4"}),e.jsx("span",{children:"Сохранить"})]}),e.jsxs("button",{onClick:j,className:"flex items-center space-x-2 px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",children:[e.jsx(H,{className:"w-4 h-4"}),e.jsx("span",{children:"Отмена"})]})]})]}):e.jsx("div",{className:"prose dark:prose-invert max-w-none",children:e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap",children:t.content})})]})},t.id))})]})},Me=()=>{const[a,y]=l.useState([]),[h,p]=l.useState(!1),[r,m]=l.useState(!0),x=l.useRef(null),{showToast:n}=E(),o=async()=>{m(!0);try{const t=await C(v.endpoints.adminAiDocsList);if(t.success&&t.data)y(t.data);else{const i=t.message||"Ошибка сервера: не удалось загрузить документы";n("error",i)}}catch(t){n("error",t?.message||"Ошибка при загрузке документов")}finally{m(!1)}};l.useEffect(()=>{o()},[]);const d=async t=>{if(!t||t.length===0)return;const i=50*1024*1024,f=[".pdf",".doc",".docx",".txt"],_=[];if(Array.from(t).forEach(D=>{const s="."+D.name.split(".").pop()?.toLowerCase();f.includes(s)||_.push(D.name),D.size>i&&_.push(`${D.name} (слишком большой)`)}),_.length>0){n("error",`Некорректные файлы: ${_.join(", ")}`);return}p(!0),n("info","Загрузка документов..."),await new Promise(D=>setTimeout(D,1500)),n("success","Документы загружены"),p(!1),await o(),x.current&&(x.current.value="")},g=async t=>{try{const i=await C(v.endpoints.adminAiDocsDelete,{method:"POST",body:JSON.stringify({id:t})});i.success?(n("success","Документ удален"),await o()):n("error",i.message||"Не удалось удалить документ")}catch{n("error","Ошибка при удалении документа")}},b=t=>{if(t===0)return"0 Bytes";const i=1024,f=["Bytes","KB","MB","GB"],_=Math.floor(Math.log(t)/Math.log(i));return Math.round(t/Math.pow(i,_)*100)/100+" "+f[_]},j=t=>{const i={processed:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",processing:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400",error:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400"};return i[t]||i.processed};return r?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Документы для ИИ"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Загружайте документы для обучения AI модели"})]}),e.jsxs("button",{onClick:()=>x.current?.click(),disabled:h,className:"flex items-center space-x-2 px-4 py-2 bg-gradient-to-r from-blue-500 to-indigo-600 text-white font-medium rounded-lg hover:from-blue-600 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:[e.jsx(ue,{className:"w-4 h-4"}),e.jsx("span",{children:h?"Загрузка...":"Загрузить документы"})]}),e.jsx("input",{ref:x,type:"file",multiple:!0,accept:".pdf,.doc,.docx,.txt",onChange:t=>d(t.target.files),className:"hidden"})]}),h&&e.jsx(w.div,{initial:{opacity:0},animate:{opacity:1},className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-500"}),e.jsx("span",{className:"text-sm text-blue-700 dark:text-blue-300",children:"Загрузка документов..."})]})}),e.jsx("div",{className:"space-y-4",children:a.length===0?e.jsxs("div",{className:"text-center py-12 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl",children:[e.jsx(ae,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-2",children:"Нет загруженных документов"}),e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500",children:"Загрузите документы для обучения AI"})]}):a.map(t=>e.jsx(w.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-green-500 to-emerald-600 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(F,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white truncate",children:t.filename}),e.jsxs("div",{className:"flex items-center space-x-3 mt-1",children:[e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:b(t.size)}),e.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full ${j(t.status)}`,children:t.status==="processed"?"Обработан":t.status==="processing"?"Обработка":"Ошибка"}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:new Date(t.uploadedAt).toLocaleDateString("ru-RU")})]})]})]}),e.jsx("div",{className:"flex items-center space-x-2 flex-shrink-0 ml-4",children:e.jsx("button",{onClick:()=>g(t.id),className:"p-2 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",title:"Удалить",children:e.jsx(Q,{className:"w-4 h-4"})})})]})},t.id))})]})},$e=()=>{const[a,y]=l.useState([]),[h,p]=l.useState(!0),[r,m]=l.useState(!1),{showToast:x}=E(),n=async()=>{p(!0);try{const t=await C(v.endpoints.backupList);if(t.success&&t.data)y(t.data);else{const i=t.message||"Не удалось загрузить бэкапы";x("error",i)}}catch(t){x("error",t?.message||"Ошибка при загрузке бэкапов")}finally{p(!1)}};l.useEffect(()=>{n()},[]);const o=async()=>{m(!0);try{const t=await C(v.endpoints.backupCreate,{method:"POST"});t.success?(await n(),alert("Бэкап создан успешно")):alert(`Ошибка: ${t.message||"Не удалось создать бэкап"}`)}catch{alert("Ошибка при создании бэкапа")}finally{m(!1)}},d=async(t,i)=>{if(confirm("ВНИМАНИЕ: Это действие перезапишет текущую базу данных. Продолжить?"))try{const f=await C(v.endpoints.backupRestore,{method:"POST",body:JSON.stringify({backup_id:t,file_path:i})});f.success?alert("Бэкап восстановлен успешно"):alert(`Ошибка: ${f.message||"Не удалось восстановить бэкап"}`)}catch{alert("Ошибка при восстановлении бэкапа")}},g=async t=>{if(confirm("Удалить этот бэкап?"))try{const i=await C(v.endpoints.backupDelete,{method:"POST",body:JSON.stringify({backup_id:t})});i.success?(await n(),alert("Бэкап удален")):alert(`Ошибка: ${i.message||"Не удалось удалить бэкап"}`)}catch{alert("Ошибка при удалении бэкапа")}},b=t=>{if(t===0)return"0 B";const i=1024,f=["B","KB","MB","GB"],_=Math.floor(Math.log(t)/Math.log(i));return Math.round(t/Math.pow(i,_)*100)/100+" "+f[_]},j=t=>new Date(t).toLocaleString("ru-RU");return h?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Бэкапы базы данных"}),e.jsx("button",{onClick:o,disabled:r,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center gap-2",children:r?e.jsxs(e.Fragment,{children:[e.jsx($,{className:"w-4 h-4 animate-spin"}),"Создание..."]}):e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"w-4 h-4"}),"Создать бэкап"]})})]}),a.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[e.jsx(G,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Нет бэкапов"})]}):e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Файл"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Размер"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Дата создания"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Статус"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Действия"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-slate-800 divide-y divide-gray-200 dark:divide-gray-700",children:a.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-slate-700",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:t.filename}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:b(t.file_size)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ye,{className:"w-4 h-4"}),j(t.created_at)]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${t.status==="completed"?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":t.status==="failed"?"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400"}`,children:t.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>d(t.id,t.file_path),className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300",children:"Восстановить"}),e.jsx("button",{onClick:()=>g(t.id),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",children:e.jsx(Q,{className:"w-4 h-4"})})]})})]},t.id))})]})})]})},Ie=()=>{const[a,y]=l.useState(null),[h,p]=l.useState([]),[r,m]=l.useState(!0),[x,n]=l.useState(!1),{showToast:o}=E(),d=async()=>{m(!0);try{const s=await C(v.endpoints.healthCheckList);s.success&&s.data?(s.data.system_status&&y(s.data.system_status),s.data.health_checks&&p(s.data.health_checks)):o("error",s.message||"Не удалось загрузить health checks")}catch{o("error","Ошибка при загрузке health checks")}finally{m(!1)}};l.useEffect(()=>{d()},[]);const g=async()=>{n(!0);try{const s=await C(v.endpoints.healthCheck,{method:"POST",body:JSON.stringify({service:"all"})});s.success?(await d(),o("success","Проверка завершена")):o("error",s.message||"Не удалось выполнить проверку")}catch{o("error","Ошибка при проверке здоровья системы")}finally{n(!1)}},b=async s=>{try{const u=await C(v.endpoints.healthCheck,{method:"POST",body:JSON.stringify({service:s})});u.success?(await d(),o("success",`Проверка ${s} завершена`)):o("error",u.message||"Не удалось выполнить проверку")}catch{o("error","Ошибка при проверке сервиса")}},t=(()=>{const s=h.filter(u=>u.service_name==="system"&&u.metrics).sort((u,S)=>new Date(u.checked_at).getTime()-new Date(S.checked_at).getTime()).slice(-20);return{cpu:s.map(u=>({value:u.metrics?.cpu_usage_percent||0,time:new Date(u.checked_at).toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"})})),memory:s.map(u=>({value:u.metrics?.memory_usage_percent||0,time:new Date(u.checked_at).toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"})})),disk:s.map(u=>({value:u.metrics?.disk_usage_percent||0,time:new Date(u.checked_at).toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit"})}))}})(),i=(s,u,S)=>{if(s.length===0)return null;const U=Math.max(...s.map(M=>M.value),100),T=100;return e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(ie,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:S})]}),e.jsxs("div",{className:"relative",style:{height:`${T}px`},children:[e.jsxs("svg",{width:"100%",height:T,className:"overflow-visible",children:[e.jsx("polyline",{points:s.map((M,I)=>{const P=I/(s.length-1||1)*100,c=T-M.value/U*T;return`${P}%,${c}`}).join(" "),fill:"none",stroke:u,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),s.map((M,I)=>{const P=I/(s.length-1||1)*100,c=T-M.value/U*T;return e.jsx("circle",{cx:`${P}%`,cy:c,r:"3",fill:u,className:"hover:r-4 transition-all"},I)})]}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400 mt-1",children:[e.jsx("span",{children:s[0]?.time}),e.jsx("span",{children:s[s.length-1]?.time})]})]})]})},f=s=>{switch(s){case"healthy":return e.jsx(ee,{className:"w-5 h-5 text-green-500"});case"unhealthy":return e.jsx(Z,{className:"w-5 h-5 text-red-500"});case"degraded":return e.jsx(O,{className:"w-5 h-5 text-yellow-500"});default:return e.jsx(O,{className:"w-5 h-5 text-gray-500"})}},_=s=>{switch(s){case"healthy":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400";case"unhealthy":return"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400";case"degraded":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}},D=["n8n","postgresql","nginx","supabase-studio"];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Health Checks"}),e.jsx("button",{onClick:g,disabled:x,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center gap-2",children:x?e.jsxs(e.Fragment,{children:[e.jsx($,{className:"w-4 h-4 animate-spin"}),"Проверка..."]}):e.jsxs(e.Fragment,{children:[e.jsx($,{className:"w-4 h-4"}),"Проверить все"]})})]}),a&&e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(pe,{className:"w-5 h-5"}),"Общий статус системы"]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${_(a.overall_status)}`,children:a.overall_status})]}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:["Последняя проверка: ",new Date(a.last_checked_at).toLocaleString("ru-RU")]}),a.system_metrics&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-slate-700 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(be,{className:"w-4 h-4 text-blue-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"CPU"})]}),e.jsxs("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[a.system_metrics.cpu_usage_percent.toFixed(1),"%"]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-slate-600 rounded-full h-2 mt-2",children:e.jsx("div",{className:`h-2 rounded-full ${a.system_metrics.cpu_usage_percent>80?"bg-red-500":a.system_metrics.cpu_usage_percent>60?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min(a.system_metrics.cpu_usage_percent,100)}%`}})})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-slate-700 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(fe,{className:"w-4 h-4 text-purple-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Память"})]}),e.jsxs("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[a.system_metrics.memory_usage_percent.toFixed(1),"%"]}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[a.system_metrics.memory_used_mb," MB / ",a.system_metrics.memory_total_mb," MB"]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-slate-600 rounded-full h-2 mt-2",children:e.jsx("div",{className:`h-2 rounded-full ${a.system_metrics.memory_usage_percent>80?"bg-red-500":a.system_metrics.memory_usage_percent>60?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min(a.system_metrics.memory_usage_percent,100)}%`}})})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-slate-700 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(G,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Диск"})]}),e.jsxs("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[a.system_metrics.disk_usage_percent.toFixed(1),"%"]}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[a.system_metrics.disk_used_gb," GB / ",a.system_metrics.disk_total_gb," GB"]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-slate-600 rounded-full h-2 mt-2",children:e.jsx("div",{className:`h-2 rounded-full ${a.system_metrics.disk_usage_percent>80?"bg-red-500":a.system_metrics.disk_usage_percent>60?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min(a.system_metrics.disk_usage_percent,100)}%`}})})]})]})]}),t.cpu.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"История метрик"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i(t.cpu,"#3b82f6","CPU"),i(t.memory,"#a855f7","Память"),i(t.disk,"#10b981","Диск")]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-6",children:D.map(s=>{const u=a?.services_status[s]||"unknown",S=h.filter(U=>U.service_name===s).sort((U,T)=>new Date(T.checked_at).getTime()-new Date(U.checked_at).getTime())[0];return e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white capitalize",children:s}),e.jsxs("div",{className:"flex items-center gap-2",children:[f(u),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${_(u)}`,children:u})]})]}),S&&e.jsxs("div",{className:"space-y-2 text-sm text-gray-600 dark:text-gray-400",children:[S.response_time_ms&&e.jsxs("p",{children:["Время ответа: ",S.response_time_ms," мс"]}),S.error_message&&e.jsxs("p",{className:"text-red-600 dark:text-red-400",children:["Ошибка: ",S.error_message]}),e.jsxs("p",{className:"text-xs",children:["Проверено: ",new Date(S.checked_at).toLocaleString("ru-RU")]})]}),e.jsxs("button",{onClick:()=>b(s),className:"mt-4 w-full px-4 py-2 bg-gray-100 dark:bg-slate-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-slate-600 flex items-center justify-center gap-2",children:[e.jsx($,{className:"w-4 h-4"}),"Проверить"]})]},s)})})]})},Pe=()=>{const[a,y]=l.useState([]),[h,p]=l.useState(!0),[r,m]=l.useState(""),[x,n]=l.useState(""),[o,d]=l.useState(1),[g,b]=l.useState(0),[j]=l.useState(50),{showToast:t}=E(),i=async()=>{p(!0);try{const s=new URLSearchParams({limit:j.toString(),offset:((o-1)*j).toString()});x&&s.append("action",x);const u=`${v.endpoints.adminLogsList}?${s}`,S=await C(u);if(S.success&&S.data)y(S.data),b(S.pagination?.total||0);else{const U=S.message||"Ошибка сервера: не удалось загрузить логи";t("error",U)}}catch(s){t("error",s?.message||"Ошибка при загрузке логов")}finally{p(!1)}};l.useEffect(()=>{i()},[o,x]);const f=a.filter(s=>{if(!r)return!0;const u=r.toLowerCase();return s.action.toLowerCase().includes(u)||s.user?.username?.toLowerCase().includes(u)||s.ip?.toLowerCase().includes(u)||JSON.stringify(s.metadata).toLowerCase().includes(u)}),_=Array.from(new Set(a.map(s=>s.action))),D=()=>{const s=[["ID","Action","Resource Type","User","IP","Created At"].join(","),...f.map(T=>[T.id,T.action,T.resourceType||"",T.user?.username||"System",T.ip||"",new Date(T.createdAt).toLocaleString("ru-RU")].join(","))].join(`
`),u=new Blob([s],{type:"text/csv"}),S=URL.createObjectURL(u),U=document.createElement("a");U.href=S,U.download=`logs-${new Date().toISOString().split("T")[0]}.csv`,U.click(),URL.revokeObjectURL(S),t("success","Логи экспортированы")};return h?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Логи системы"}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:["Всего записей: ",g]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:i,className:"flex items-center space-x-2 px-4 py-2 bg-gray-100 dark:bg-slate-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-slate-600 transition-colors",children:[e.jsx($,{className:"w-4 h-4"}),e.jsx("span",{children:"Обновить"})]}),e.jsxs("button",{onClick:D,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(re,{className:"w-4 h-4"}),e.jsx("span",{children:"Экспорт CSV"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(V,{className:"w-5 h-5 text-gray-400"})}),e.jsx("input",{type:"text",value:r,onChange:s=>m(s.target.value),placeholder:"Поиск по логам...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-slate-700 text-gray-900 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(je,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsxs("select",{value:x,onChange:s=>{n(s.target.value),d(1)},className:"pl-10 pr-8 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-slate-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Все действия"}),_.map(s=>e.jsx("option",{value:s,children:s},s))]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-slate-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Время"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Действие"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Пользователь"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Ресурс"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"IP"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:f.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-gray-500 dark:text-gray-400",children:"Логи не найдены"})}):f.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-slate-700",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 dark:text-white",children:s.createdAt?new Date(s.createdAt).toLocaleString("ru-RU"):"-"}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400",children:s.action})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 dark:text-white",children:s.user?`${s.user.username} (${s.user.firstName} ${s.user.lastName})`:"System"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-500 dark:text-gray-400",children:s.resourceType?`${s.resourceType}:${s.resourceId?.substring(0,8)}`:"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-500 dark:text-gray-400",children:s.ip||"-"})]},s.id))})]})}),g>j&&e.jsxs("div",{className:"px-4 py-3 border-t border-gray-200 dark:border-gray-700 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Показано ",(o-1)*j+1," - ",Math.min(o*j,g)," из ",g]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>d(s=>Math.max(1,s-1)),disabled:o===1,className:"px-3 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-slate-700 text-gray-700 dark:text-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50 dark:hover:bg-slate-600",children:"Назад"}),e.jsxs("span",{className:"px-3 py-1 text-sm text-gray-700 dark:text-gray-300",children:["Страница ",o," из ",Math.ceil(g/j)]}),e.jsx("button",{onClick:()=>d(s=>Math.min(Math.ceil(g/j),s+1)),disabled:o>=Math.ceil(g/j),className:"px-3 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-slate-700 text-gray-700 dark:text-gray-300 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50 dark:hover:bg-slate-600",children:"Вперед"})]})]})]})]})},Oe=()=>{const[a,y]=l.useState([]),[h,p]=l.useState([]),[r,m]=l.useState(""),[x,n]=l.useState(null),[o,d]=l.useState(null),[g,b]=l.useState(0),[j,t]=l.useState(!0),[i,f]=l.useState(null),[_,D]=l.useState(100),{showToast:s}=E(),u=async()=>{t(!0);try{const c=new URLSearchParams;r&&c.append("search",r);const L=`${v.endpoints.adminUsersList}?${c}`,N=await C(L);if(N.success&&N.data)y(N.data);else{const k=N.message||"Ошибка сервера: не удалось загрузить пользователей";s("error",k)}}catch(c){s("error",c?.message||"Ошибка при загрузке пользователей")}finally{t(!1)}},S=async c=>{try{const L=new URLSearchParams;c&&L.append("user_id",c);const N=`${v.endpoints.adminUserLimitsList}?${L}`,k=await C(N);k.success&&k.data&&p(k.data)}catch{}};l.useEffect(()=>{u()},[]),l.useEffect(()=>{x&&S(x)},[x]);const U=async(c,L)=>{try{const N=await C(v.endpoints.adminUserLimitsUpdate,{method:"POST",body:JSON.stringify({user_id:c,limit_type:L,limit_value:g})});N.success?(s("success","Лимит обновлен"),await S(c),d(null)):s("error",N.message||"Не удалось обновить лимит")}catch{s("error","Ошибка при обновлении лимита")}},T=async(c,L)=>{if(confirm(`Очистить всю историю пользователя ${L}?`))try{const N=await C(v.endpoints.adminUserHistoryClear,{method:"POST",body:JSON.stringify({user_id:c})});N.success?(s("success","История очищена"),await u()):s("error",N.message||"Не удалось очистить историю")}catch{s("error","Ошибка при очистке истории")}},M=async(c,L)=>{if(confirm(`УДАЛИТЬ ПОЛЬЗОВАТЕЛЯ ${L} ПОЛНОСТЬЮ?

Будут удалены:
- Все чаты и сообщения
- Все лимиты
- Связи с компаниями
- Сам пользователь

Это действие необратимо!`))try{const N=await C(v.endpoints.adminUserDelete,{method:"POST",body:JSON.stringify({user_id:c})});N.success?(s("success","Пользователь удалён"),await u()):s("error",N.message||"Не удалось удалить пользователя")}catch{s("error","Ошибка при удалении пользователя")}},I=async(c,L)=>{try{const N=await C(v.endpoints.adminUserLimitsUpdate,{method:"POST",body:JSON.stringify({user_id:c,limit_type:"daily_requests",limit_value:L})});N.success?(s("success","Лимиты обновлены"),f(null),await u(),x&&await S(x)):s("error",N.message||"Не удалось обновить лимиты")}catch{s("error","Ошибка при обновлении лимитов")}},P=a.filter(c=>{if(!r)return!0;const L=r.toLowerCase();return c.username?.toLowerCase().includes(L)||c.firstName?.toLowerCase().includes(L)||c.lastName?.toLowerCase().includes(L)||c.telegramId.toString().includes(L)});return j?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Пользователи"}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:["Всего пользователей: ",a.length]})]})}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(V,{className:"w-5 h-5 text-gray-400"})}),e.jsx("input",{type:"text",value:r,onChange:c=>m(c.target.value),placeholder:"Поиск по имени, username или Telegram ID...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-slate-700 text-gray-900 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsx("div",{className:"space-y-4",children:P.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(R,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:r?"Пользователи не найдены":"Нет пользователей"})]}):P.map(c=>{const L=h.filter(k=>k.userId===c.id),N=c.companies[0]?.role||"viewer";return e.jsxs(w.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"p-4 cursor-pointer hover:bg-gray-50 dark:hover:bg-slate-700 transition-colors",onClick:()=>n(x===c.id?null:c.id),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-pink-600 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(R,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:[c.firstName," ",c.lastName," ",c.username&&`(@${c.username})`]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1 text-sm text-gray-500 dark:text-gray-400",children:[e.jsxs("span",{children:["TG ID: ",c.telegramId]}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-semibold ${N==="owner"?"bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-300":N==="manager"?"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300":"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-300"}`,children:N}),e.jsxs("span",{children:[c.chatsCount," чатов"]}),e.jsx("span",{children:c.companies.length>0?`${c.companies.length} компаний`:"Нет компании"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:k=>{k.stopPropagation(),f(c),D(L.find(A=>A.limitType==="daily_requests")?.limitValue||100)},className:"p-2 text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors",title:"Задать лимиты",children:e.jsx(ke,{className:"w-5 h-5"})}),e.jsx("button",{onClick:k=>{k.stopPropagation(),T(c.id,c.username||c.firstName||"пользователя")},className:"p-2 text-orange-600 hover:bg-orange-50 dark:hover:bg-orange-900/20 rounded-lg transition-colors",title:"Очистить историю",children:e.jsx($,{className:"w-5 h-5"})}),e.jsx("button",{onClick:k=>{k.stopPropagation(),M(c.id,c.username||c.firstName||"пользователя")},className:"p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",title:"Удалить пользователя",children:e.jsx(Q,{className:"w-5 h-5"})}),e.jsx(we,{className:"w-5 h-5 text-gray-400"})]})]})}),x===c.id&&e.jsx(w.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-slate-900/50",children:e.jsxs("div",{className:"p-4 space-y-4",children:[c.companies.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Компании:"}),e.jsx("div",{className:"space-y-2",children:c.companies.map((k,A)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-white dark:bg-slate-800 rounded-lg",children:[e.jsxs("span",{className:"text-sm text-gray-900 dark:text-white",children:["ID: ",k.company_id]}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-semibold ${k.role==="owner"?"bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-300":k.role==="manager"?"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300":"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-300"}`,children:k.role})]},A))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Лимиты:"}),e.jsx("div",{className:"space-y-2",children:L.length===0?e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Нет установленных лимитов"}):L.map(k=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-white dark:bg-slate-800 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm text-gray-900 dark:text-white",children:k.limitType}),o===k.id?e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx("input",{type:"number",value:g,onChange:A=>b(parseInt(A.target.value)||0),className:"w-24 px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-slate-700 text-gray-900 dark:text-white"}),e.jsx("button",{onClick:A=>{A.stopPropagation(),U(c.id,k.limitType)},className:"p-1 text-green-600 hover:bg-green-50 dark:hover:bg-green-900/20 rounded",children:e.jsx(se,{className:"w-4 h-4"})}),e.jsx("button",{onClick:A=>{A.stopPropagation(),d(null),b(0)},className:"p-1 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded",children:e.jsx(H,{className:"w-4 h-4"})})]}):e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Использовано: ",k.currentUsage," / ",k.limitValue]})]}),o!==k.id&&e.jsx("button",{onClick:A=>{A.stopPropagation(),d(k.id),b(k.limitValue)},className:"p-1 text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded",children:e.jsx(te,{className:"w-4 h-4"})})]},k.id))})]})]})})]},c.id)})}),i&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",onClick:()=>f(null),children:e.jsxs(w.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl p-6 max-w-md w-full mx-4",onClick:c=>c.stopPropagation(),children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4",children:"Управление лимитами"}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:["Пользователь: ",i.firstName," ",i.lastName," (@",i.username,")"]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Дневной лимит запросов"}),e.jsx("input",{type:"number",value:_,onChange:c=>D(parseInt(c.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-slate-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500",min:"0"}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Текущее использование: ",h.find(c=>c.userId===i.id&&c.limitType==="daily_requests")?.currentUsage||0," / ",h.find(c=>c.userId===i.id&&c.limitType==="daily_requests")?.limitValue||0]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:()=>f(null),className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-slate-700 transition-colors",children:"Отмена"}),e.jsx("button",{onClick:()=>I(i.id,_),className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Сохранить"})]})]})})]})},Re=()=>{const[a,y]=l.useState(null),[h,p]=l.useState(!0),{showToast:r}=E(),m=async()=>{p(!0);try{const n=await C(v.endpoints.adminStatsPlatform);if(n.success&&n.data)y(n.data);else{const o=n.message||"Ошибка сервера: не удалось загрузить статистику";r("error",o)}}catch(n){r("error",n?.message||"Ошибка при загрузке статистики")}finally{p(!1)}};if(l.useEffect(()=>{m()},[]),h)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})});if(!a)return e.jsxs("div",{className:"text-center py-12",children:[e.jsx(J,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Нет данных"})]});const x=[{title:"Всего пользователей",value:a.totalUsers,icon:R,color:"blue",change:a.newUsers30d,changeLabel:"новых за 30 дней"},{title:"Активных (30 дней)",value:a.activeUsers30d,icon:ne,color:"green",change:a.activeUsers7d,changeLabel:"активных за 7 дней"},{title:"Всего компаний",value:a.totalCompanies,icon:B,color:"purple",change:a.newCompanies30d,changeLabel:"новых за 30 дней"},{title:"Всего чатов",value:a.totalChats,icon:W,color:"indigo"},{title:"Всего сообщений",value:a.totalMessages,icon:W,color:"pink"},{title:"Активных сессий",value:a.activeSessions,icon:ie,color:"orange"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Аналитика платформы"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Статистика использования Lumon Platform"})]}),e.jsx("button",{onClick:m,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Обновить"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:x.map((n,o)=>{const d=n.icon,g={blue:"bg-blue-500",green:"bg-green-500",purple:"bg-purple-500",indigo:"bg-indigo-500",pink:"bg-pink-500",orange:"bg-orange-500"};return e.jsxs(w.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:o*.1},className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("div",{className:`w-12 h-12 ${g[n.color]} rounded-lg flex items-center justify-center`,children:e.jsx(d,{className:"w-6 h-6 text-white"})})}),e.jsx("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2",children:n.title}),e.jsx("div",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:n.value.toLocaleString("ru-RU")}),n.change!==void 0&&e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[n.change>0&&"+",n.change," ",n.changeLabel]})]},o)})}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Графики использования"}),e.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[e.jsx(J,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"Графики будут добавлены в следующей версии"})]})]})]})},Be=()=>{const[a,y]=l.useState([]),[h,p]=l.useState(!0),[r,m]=l.useState(!1);l.useState(null);const{showToast:x}=E(),n=async()=>{p(!0);try{const d=await C(v.endpoints.adminAbExperimentsList);if(d.success&&d.data)y(d.data);else{const g=d.message||"Ошибка сервера: не удалось загрузить эксперименты";x("error",g)}}catch(d){x("error",d?.message||"Ошибка при загрузке экспериментов")}finally{p(!1)}};l.useEffect(()=>{n()},[]);const o=async(d,g)=>{try{const b=await C(v.endpoints.adminAbExperimentUpdate,{method:"POST",body:JSON.stringify({id:d,enabled:!g})});b.success?(x("success",g?"Эксперимент отключен":"Эксперимент включен"),await n()):x("error",b.message||"Не удалось обновить эксперимент")}catch{x("error","Ошибка при обновлении эксперимента")}};return h?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"A/B Тестирование"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Управление экспериментами"})]}),e.jsxs("button",{onClick:()=>m(!0),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(Ne,{className:"w-4 h-4"}),e.jsx("span",{children:"Создать эксперимент"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.length===0?e.jsxs("div",{className:"col-span-2 text-center py-12",children:[e.jsx(le,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Нет экспериментов"})]}):a.map(d=>e.jsxs(w.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:d.name}),d.description&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:d.description})]}),e.jsx("button",{onClick:()=>o(d.id,d.enabled),className:"ml-2",children:d.enabled?e.jsx(ve,{className:"w-6 h-6 text-green-500"}):e.jsx(Se,{className:"w-6 h-6 text-gray-400"})})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Функция:"}),e.jsx("span",{className:"text-gray-900 dark:text-white font-medium",children:d.featureName})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Трафик:"}),e.jsxs("span",{className:"text-gray-900 dark:text-white font-medium",children:[d.trafficPercentage,"%"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Вариант A:"}),e.jsxs("span",{className:"text-gray-900 dark:text-white font-medium",children:[d.variantAUsers," пользователей"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Вариант B:"}),e.jsxs("span",{className:"text-gray-900 dark:text-white font-medium",children:[d.variantBUsers," пользователей"]})]})]})]},d.id))})]})},Fe=()=>{const[a,y]=l.useState(!1),[h,p]=l.useState("companies"),[r,m]=l.useState(!0);l.useEffect(()=>{localStorage.getItem("admin_token")&&y(!0)},[]);const x=d=>{localStorage.setItem("admin_token",d),y(!0)},n=()=>{localStorage.removeItem("admin_token"),y(!1)};if(l.useEffect(()=>{(()=>{window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")})();const g=window.matchMedia("(prefers-color-scheme: dark)"),b=j=>{j.matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")};return g.addEventListener?(g.addEventListener("change",b),()=>{g.removeEventListener("change",b)}):(g.addListener(b),()=>{g.removeListener(b)})},[]),l.useEffect(()=>(document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden",()=>{document.body.style.overflow="",document.documentElement.style.overflow=""}),[]),!a)return e.jsx(Ue,{onLogin:x});const o=[{id:"companies",label:"Компании",icon:B},{id:"legal",label:"Юр документы",icon:F},{id:"ai-docs",label:"Документы для ИИ",icon:ae},{id:"backups",label:"Бэкапы",icon:G},{id:"health",label:"Health Checks",icon:ne},{id:"logs",label:"Логи",icon:_e},{id:"users",label:"Пользователи",icon:R},{id:"analytics",label:"Аналитика",icon:J},{id:"ab-testing",label:"A/B Тесты",icon:le}];return e.jsx(De,{children:e.jsxs("div",{className:"min-h-screen bg-white dark:bg-slate-950 fixed inset-0 overflow-hidden flex",children:[e.jsxs(w.aside,{initial:!1,animate:{width:r?"256px":"64px"},className:"bg-white dark:bg-slate-900 border-r border-gray-200 dark:border-slate-800 flex flex-col h-full transition-all duration-200",children:[e.jsxs("div",{className:"h-16 border-b border-gray-200 dark:border-slate-800 flex items-center justify-between px-4",children:[r&&e.jsxs(w.div,{initial:{opacity:0},animate:{opacity:1},className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-slate-900 dark:bg-white rounded-lg flex items-center justify-center",children:e.jsx(q,{className:"w-5 h-5 text-white dark:text-slate-900"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:"Админ-панель"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Lumon"})]})]}),!r&&e.jsx("div",{className:"w-8 h-8 bg-slate-900 dark:bg-white rounded-lg flex items-center justify-center mx-auto",children:e.jsx(q,{className:"w-5 h-5 text-white dark:text-slate-900"})}),e.jsx("button",{onClick:()=>m(!r),className:"p-1.5 rounded-lg hover:bg-gray-100 dark:hover:bg-slate-800 text-gray-600 dark:text-gray-400 transition-colors",children:r?e.jsx(H,{className:"w-4 h-4"}):e.jsx(Le,{className:"w-4 h-4"})})]}),e.jsx("nav",{className:"flex-1 overflow-y-auto py-4 px-2 scrollbar-thin",children:o.map(d=>{const g=d.icon,b=h===d.id;return e.jsxs(w.button,{onClick:()=>p(d.id),className:`
                    w-full flex items-center space-x-3 px-3 py-2.5 rounded-lg mb-1 transition-all duration-150
                    ${b?"bg-slate-100 dark:bg-slate-800 text-slate-900 dark:text-white":"text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-slate-800/50 hover:text-gray-900 dark:hover:text-white"}
                  `,whileHover:{x:2},whileTap:{scale:.98},children:[e.jsx(g,{className:`w-5 h-5 flex-shrink-0 ${b?"text-slate-900 dark:text-white":""}`}),r&&e.jsx(w.span,{initial:{opacity:0},animate:{opacity:1},className:"text-sm font-medium whitespace-nowrap",children:d.label})]},d.id)})}),e.jsx("div",{className:"border-t border-gray-200 dark:border-slate-800 p-4",children:e.jsxs(w.button,{onClick:n,className:"w-full flex items-center space-x-3 px-3 py-2.5 rounded-lg text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-slate-800/50 hover:text-gray-900 dark:hover:text-white transition-all duration-150",whileHover:{x:2},whileTap:{scale:.98},children:[e.jsx(Ce,{className:"w-5 h-5 flex-shrink-0"}),r&&e.jsx(w.span,{initial:{opacity:0},animate:{opacity:1},className:"text-sm font-medium",children:"Выйти"})]})})]}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx("div",{className:"h-16 border-b border-gray-200 dark:border-slate-800 bg-white dark:bg-slate-900 flex items-center px-6",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:o.find(d=>d.id===h)?.label})}),e.jsx("div",{className:"flex-1 overflow-y-auto bg-gray-50 dark:bg-slate-950 scrollbar-thin",children:e.jsx("div",{className:"p-6",children:e.jsxs(Y,{mode:"wait",children:[h==="companies"&&e.jsx(w.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:e.jsx(Ae,{})},"companies"),h==="legal"&&e.jsx(w.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:e.jsx(Ee,{})},"legal"),h==="ai-docs"&&e.jsx(w.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:e.jsx(Me,{})},"ai-docs"),h==="backups"&&e.jsx(w.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:e.jsx($e,{})},"backups"),h==="health"&&e.jsx(w.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:e.jsx(Ie,{})},"health"),h==="logs"&&e.jsx(w.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:e.jsx(Pe,{})},"logs"),h==="users"&&e.jsx(w.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:e.jsx(Oe,{})},"users"),h==="analytics"&&e.jsx(w.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:e.jsx(Re,{})},"analytics"),h==="ab-testing"&&e.jsx(w.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:e.jsx(Be,{})},"ab-testing")]})})})]})]})})};const He=()=>{window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")};He();z.createRoot(document.getElementById("root")).render(e.jsx(xe.StrictMode,{children:e.jsx(Fe,{})}));
